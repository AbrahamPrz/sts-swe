709 if (!SerialDate.isValidWeekdayCode(targetDOW)) { 710 throw new IllegalArgumentException( 711 “Invalid day-of-the-week code.” 712 ); 713 } 714 715 // buscar la fecha… 716 final int baseDOW = base.getDayOfWeek(); 717 int adjust = -Math.abs(targetDOW - baseDOW); 718 if (adjust >= 4) { 719 adjust = 7 - adjust; 720 } 721 if (adjust <= -4) { 722 adjust = 7 + adjust; 723 } 724 return SerialDate.addDays(adjust, base); 725 726 } 727 728 /** 729 * Avanzar la fecha hasta el último día del mes. 730 * 731 * @param base la fecha base. 732 * 733 * @return una nueva fecha de serie. 734 */ 735 public SerialDate getEndOfCurrentMonth(final SerialDate base) { 736 final int last = SerialDate.lastDayOfMonth( 737 base.getMonth(), base.getYYYY() 738 ); 739 return SerialDate.createInstance(last, base.getMonth(), base.getYYYY()); 740 } 741 742 /** 743 * Devuelve una cadena correspondiente al código de la semana del mes. 744 * <P> 745 * Necesitamos un enfoque mejor. 746 * 747 * @param count un código entero que representa la semana del mes. 748 * 749 * @return una cadena correspondiente al código de la semana del mes. 750 */ 751 public static String weekInMonthToString(final int count) { 752 455