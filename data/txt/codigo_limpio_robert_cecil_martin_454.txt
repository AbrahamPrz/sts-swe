709 if (!serialdate.isvalidweekdaycode(targetdow)) { 710 throw new illegalargumentexception( 711 “invalid day-of-the-week code.” 712 ); 713 } 714 715 // buscar la fecha… 716 final int basedow = base.getdayofweek(); 717 int adjust = -math.abs(targetdow - basedow); 718 if (adjust >= 4) { 719 adjust = 7 - adjust; 720 } 721 if (adjust <= -4) { 722 adjust = 7 + adjust; 723 } 724 return serialdate.adddays(adjust, base); 725 726 } 727 728 /** 729 * avanzar la fecha hasta el último día del mes. 730 * 731 * @param base la fecha base. 732 * 733 * @return una nueva fecha de serie. 734 */ 735 public serialdate getendofcurrentmonth(final serialdate base) { 736 final int last = serialdate.lastdayofmonth( 737 base.getmonth(), base.getyyyy() 738 ); 739 return serialdate.createinstance(last, base.getmonth(), base.getyyyy()); 740 } 741 742 /** 743 * devuelve una cadena correspondiente al código de la semana del mes. 744 * <p> 745 * necesitamos un enfoque mejor. 746 * 747 * @param count un código entero que representa la semana del mes. 748 * 749 * @return una cadena correspondiente al código de la semana del mes. 750 */ 751 public static string weekinmonthtostring(final int count) { 752 455