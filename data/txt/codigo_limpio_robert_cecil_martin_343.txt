public static final int earliest_date_ordinal = 2; // 1/1/1900 public static final int latest_date_ordinal = 2958465; // 12/31/9999 desconozco por qué earliest_date_ordinal es 2 en lugar de 0. el comentario de la línea 829 sugiere que tiene que ver con la forma de representar fechas en microsoft excel. hay información mucho más completa en una variante de daydate : spreadsheetdate (véase el listado b-5). el comentario de la línea 71 describe este problema. el problema parece relacionado con la implementación de spreadsheetdate y no con daydate . mi conclusión es que earliest_date_ordinal y latest_date_ordinal no pertenecen a daydate y deberían cambiarse a spreadsheetdate [g6]. de hecho, una búsqueda en el código demuestra que estas variables sólo se usan en spreadsheetdate . ni en daydate , ni en otras clases de la estructura jcommon. por lo tanto, las cambio por spreadsheetdate . las siguientes variables, minimum_year_supported y maximum_year_supported (líneas 104 y 107), constituyen un dilema. parece evidente que si daydate es una clase abstracta que no dice nada sobre implementación, no debería informarnos de un año mínimo o máximo. de nuevo, siento la necesidad de cambiar las variables a spreadsheetdate [g6]. pero una búsqueda rápida de los usuarios de estas variables muestra que otra clase las utiliza: relativedayofweekrule (véase el listado b-6), vemos dicho uso en las líneas 177 y 178, en la función getdate , donde se usan para comprobar que el argumento de getdate sea un año válido. el dilema es que un usuario de una clase abstracta necesita información sobre su implementación. tendremos que proporcionar esta información sin contaminar daydate . por lo general, obtendríamos la información de implementación de una instancia de una variante. sin embargo, la función getdate no recibe una instancia de daydate , aunque sí la devuelve, lo que significa que debe crearla en alguna parte. la solución está en las líneas 187-205. la instancia daydate se crea por medio de una de estas tres funciones: getpreviousdayofweek , getnearestdayofweek o getfollowingdayofweek . si nos fijamos en el 344