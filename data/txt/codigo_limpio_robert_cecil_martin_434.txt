handle(e); } } } private void handle(Exception e) { if (!(e instanceof SocketException)) { e.printStackTrace(); } } public void stopProcessing() { keepProcessing = false; closeIgnoringException(serverSocket); } void process(Socket socket) { if (socket == null) return; try { System.out.printf(“Server: getting message\n”); String message = MessageUtils.getMessage(socket); System.out.printf(“Server: got message: %s\n”, message); Thread.sleep(1000); System.out.printf(“Server: sending reply: %s\n”, message); MessageUtils.sendMessage(socket, “Processed: ” + message); System.out.printf(“Server: sent\n”); closeIgnoringException(socket); } catch (Exception e) { e.printStackTrace(); } } private void closeIgnoringException(Socket socket) { if (socket != null) try { socket.close(); } catch (IOException ignore) { } } private void closeIgnoringException(ServerSocket serverSocket) { if (serverSocket != null) try { serverSocket.close(); } catch (IOException ignore) { } } } Listado A-5 435